{% extends 'base.html' %}

{% block title %}Recepci√≥n de Materia Prima{% endblock %}

{% block content %}
<div class="container">
    <h2>üì¶ Listar Recepci√≥n de Materia Prima</h2>
    <div class="header-row d-flex justify-content-between align-items-center mb-3">
        <div class="acciones" style="margin-bottom: 15px;">
            {% if tiene_permiso('recepcion.crear') %}
                <a href="{{ url_for('recepcion.nueva_recepcion') }}" class="btn btn-success">‚ûï Nueva Recepci√≥n</a>
            {% endif %}
        </div>
        <div class="form-row-busqueda">
            <!-- Campo de b√∫squeda -->
            <div class="form-group me-2">
                <label for="buscarRecepcion">Buscar (c√≥digo, agricultor, producto o usuario)</label>
                <input type="text" id="buscarRecepcion" class="form-control" placeholder="Buscar recepci√≥n...">
            </div>

            <!-- Bot√≥n de reporte -->
            <div class="form-group">
                {% if tiene_permiso('recepciones.ver') %}
                    <a href="{{ url_for('reportes.vista_reporte_recepciones') }}" class="btn btn-secondary">üìä Ver Reporte de notas</a>
                    <a href="{{ url_for('reportes.vista_reporte_materia_prima') }}" class="btn btn-info">‚öñÔ∏èReporte total Materia Prima</a>
                {% endif %}
            </div>
        </div>
        
    </div>
    

    
    <table class="table table-striped table-hover align-middle">
        <thead class="table-dark text-center">
            <tr>
                <th>#</th>
                <th>C√≥digo Recepci√≥n</th>
                <th>Agricultor</th>
                <th>Fecha</th>
                <th>Peso Bruto (kg)</th>
                <th>Jabas Entregadas</th>
                <th>Peso Neto (kg)</th>
                <th>Saldo Jabas</th>
                <th>Estado</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody class="text-center">
            {% include 'recepcion/_tabla_recepciones.html' %}
        </tbody>
    </table>
</div>

<!-- MODAL CAMBIAR ESTADO -->
<div id="modalEstado" class="modal-overlay" style="display:none;">
  <div class="modal-window">
    <form method="POST" id="formCambiarEstado">
      <input type="hidden" name="id_recepcion" id="estado_id_recepcion">

      <div class="form-group">
        <label for="estado">Nuevo Estado</label>
        <select name="estado" id="estado" class="form-control" required>
          <option value="">-- Seleccione --</option>
          <option value="pendiente">Pendiente</option>
          <option value="aprobado">Aprobado</option>
          <option value="anulado">Anulado</option>
        </select>
      </div>

      <div class="modal-actions">
        <button type="submit" class="btn btn-success">Guardar</button>
        <button type="button" id="cerrarModalEstado" class="btn btn-secondary">Cancelar</button>
      </div>
    </form>
  </div>
</div>


<script src="{{ url_for('static', filename='js/recepcion.js') }}"></script>

{% endblock %}
