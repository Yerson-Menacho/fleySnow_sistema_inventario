<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Reporte de Nota de Movimiento</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/bootstrap.min.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/estilos.css') }}">
</head>
<body>

    <div class="container mt-4" id="reporteNotaMovimiento">

        <!-- üè¢ CABECERA EMPRESARIAL -->
        <div class="form-row_fila2">
            <div class="form-group">
                <img src="{{ url_for('static', filename='img/logo.png') }}" alt="Logo" style="height: 70px;">
            </div>
            <div class="form-group">
                <h4 class="fw-bold text-success mb-1">FLEY & SNOW INTERNATIONAL PRODUCE E.I.R.L.</h4>
                <p class="mb-0 small text-muted">RUC: 20610415726<br>Direcci√≥n: Otr. Sector Conchuc Lote 7, Caraz, Huaylas, √Åncash, Per√∫</p>
            </div>
        </div>        

        <!-- üìã ENCABEZADO DEL REPORTE -->
        <h2 class="fw-bold mb-0">üìÑ Nota de Movimiento</h2>
        <div class="form-row-cuatro">
            <div class="form-group"><p><strong>C√≥digo: </strong>{{ cabecera.codigo_nota }}</p></div>
            <div class="form-group"><p><strong>Fecha: </strong>{{ cabecera.fecha.strftime('%Y-%m-%d') }}</p></div>
            <div class="form-group"><p><strong>Hora: </strong>{{ now.strftime('%H:%M') }}</p></div>
            <div class="form-group"><p><strong>Responsable:</strong> {{ cabecera.usuario or '‚Äî' }}</p></div>
        </div>

        <!-- DATOS PRINCIPALES -->
        <div class="form-row-3">
            <div class="form-group"><p><strong>Tipo de <br> movimiento:</strong> {{ cabecera.tipo_movimiento }}</p></div>
            <div class="form-group"><p><strong>Origen/Destino:</strong> {{ cabecera.origen_destino or '‚Äî' }}</p></div>    
            <div class="form-group"><p><strong>Referencia:</strong> {{ cabecera.referencia or '‚Äî' }}</p></div>   
        </div>
        <div class="form-row-ob">  
            <!-- OBSERVACIONES -->
            <div class="form-group"><p><strong>Observaciones: </strong>{{ cabecera.observacion or '‚Äî' }}</p></div>          
            <div class="form-group"><p><strong>Estado: </strong>
                    {% if cabecera.estado|lower == 'pendiente' %}
                        <span class="badge bg-warning text-dark">Pendiente</span>
                    {% elif cabecera.estado|lower == 'aprobado' %}
                        <span class="badge bg-success">Aprobado</span>
                    {% elif cabecera.estado|lower == 'anulado' %}
                        <span class="badge bg-danger">Anulado</span>
                    {% else %}
                        <span class="badge bg-secondary">{{ cabecera.estado }}</span>
                    {% endif %}
                </p>
            </div>
            
        </div>

        <!-- DETALLE DE INSUMOS -->
        <h3 class="border-bottom pb-2 text-center">üì¶ Detalle de Insumos</h3>
        <table id="tabla-notas" class="table table-striped table-bordered mt-3">
            <thead>
                <tr>
                    <th>#</th>
                    <th>Insumo</th>
                    <th>Cantidad</th>
                    <th>Unidad</th>
                </tr>
            </thead>
            <tbody>
                {% for d in detalles %}
                <tr>
                    <td>{{ loop.index }}</td>
                    <td>{{ d.nombre_insumo }}</td>
                    <td>{{ d.cantidad }}</td>
                    <td>{{ d.unidad_medida }}</td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="5" class="text-center text-muted">No hay detalles registrados.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>    

        <!-- FIRMA -->
        <!-- üîπ FIRMAS (Agricultor y Responsable) -->
        <div class="form-row-firma">
            <div class="form-group"><p>________________________________</p>
                <p><strong>{{ cabecera.origen_destino or '‚Äî' }}</strong></p>
                <p><small>Firma y Sello</small></p>
            </div>
            
            <div class="form-group"><p>________________________________</p>
                <p><strong>{{ cabecera.usuario or 'Responsable' }}</strong></p>
                <p><small>Firma y Sello</small></p>
            </div>
        </div>

        <!-- üîπ BOTONES (ocultos al imprimir) -->
        <div class="form-group mt-4 d-print-none">
            <button class="btn btn-primary me-2" onclick="window.print()">üñ®Ô∏è Imprimir</button>
            <a href="{{ url_for('movimientos.index') }}" class="btn btn-secondary">‚¨ÖÔ∏è Volver</a>
        </div>
    </div>

</body>
</html>
<!-- üî∏ ESTILOS DE IMPRESI√ìN -->
<style>
    @media print {
        .d-print-none { display: none !important; }
        body {
            background: white !important;
            color: black;
            margin: 0;
            font-size: 11pt;
        }
        table {
            border-collapse: collapse !important;
            width: 100%;
        }
        th, td {
            border: 1px solid #000 !important;
            padding: 6px;
        }
        h3 {
            color: black !important;
        }
    }
</style>