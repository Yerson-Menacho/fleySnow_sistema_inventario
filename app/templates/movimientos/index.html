{% extends 'base.html' %}

{% block title %}Notas de Movimientos{% endblock %}

{% block content %}
<div class="container">    
    <h2>ðŸ“‘ Lista de Notas de Movimientos</h2>
    <div class="header-row d-flex justify-content-between align-items-center mb-3">
        <div class="acciones" style="margin-bottom: 15px;">
            {% if tiene_permiso('movimientos.crear') %}
                <a href="{{ url_for('movimientos.nuevo_movimiento') }}" class="btn btn-success">âž• Registrar Nota</a>
            {% endif %}
        </div>    
        <div class="form-row-busqueda">
            <!-- Campo de bÃºsqueda -->
            <div class="form-group me-2">
                <label for="buscarMovimiento">Buscar (cÃ³digo, tipo, usuario u origen)</label>
                <input type="text" id="buscarMovimiento" class="form-control" placeholder="Buscar movimiento...">
            </div>

            <!-- BotÃ³n de reporte -->
            <div class="form-group">
                {% if tiene_permiso('movimientos.ver') %}
                    <a href="{{ url_for('reportes.vista_reporte_movimientos') }}" class="btn btn-secondary">
                        ðŸ“Š Ver Reporte
                    </a>
                {% endif %}
            </div>
        </div>
    </div>
      

    <table class="table table-striped table-hover align-middle">
        <thead class="table-dark">
            <tr>
                <th>ID</th>
                <th>CÃ³digo</th>
                <th>Tipo</th>
                <th>Fecha</th>
                <th>Origen/Destino</th>
                <th>Usuario</th>
                <th>Estado</th>
                <th>Observaciones</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody>
            {% include 'movimientos/_tabla_movimientos.html' %}
        </tbody>
    </table>
</div>

<!-- MODAL CAMBIAR ESTADO -->
<div id="modalEstado" class="modal-overlay" style="display:none;">
    <div class="modal-window">
        <form id="formCambiarEstado" method="POST">
            <div class="form-group">
                <label for="estado">Cambiar estado:</label>
                <select id="estado" name="estado" class="form-control" required>
                    <option value="">-- Selecciona --</option>
                    <option value="pendiente">Pendiente</option>
                    <option value="aprobado">Aprobado</option>
                    <option value="anulado">Anulado</option>
                </select>
            </div>
            <div class="modal-actions">
                <button type="submit" class="btn btn-success">Guardar</button>
                <button type="button" id="cerrarModalEstado" class="btn btn-secondary">Cancelar</button>
            </div>
        </form>
    </div>
</div>


<script src="{{ url_for('static', filename='js/movimientos.js') }}"></script>
{% endblock %}
